{"version":3,"sources":["../../../src/common/filters/all-exceptions.filter.ts"],"sourcesContent":["import {\r\n    ExceptionFilter,\r\n    Catch,\r\n    ArgumentsHost,\r\n    HttpException,\r\n    HttpStatus,\r\n} from '@nestjs/common';\r\nimport { Response } from 'express';\r\n\r\n@Catch()\r\nexport class AllExceptionsFilter implements ExceptionFilter {\r\n    catch(exception: unknown, host: ArgumentsHost) {\r\n        const ctx = host.switchToHttp();\r\n        const response = ctx.getResponse<Response>();\r\n        const request = ctx.getRequest();\r\n\r\n        let status = HttpStatus.INTERNAL_SERVER_ERROR;\r\n        let message = 'Internal server error';\r\n        let errors: any = null;\r\n\r\n        if (exception instanceof HttpException) {\r\n            status = exception.getStatus();\r\n            const exceptionResponse = exception.getResponse();\r\n\r\n            if (typeof exceptionResponse === 'string') {\r\n                message = exceptionResponse;\r\n            } else if (typeof exceptionResponse === 'object') {\r\n                const responseObj = exceptionResponse as any;\r\n                message = responseObj.message || message;\r\n                errors = responseObj.errors || null;\r\n            }\r\n        } else if (exception instanceof Error) {\r\n            message = exception.message;\r\n        }\r\n\r\n        // Log error in development\r\n        if (process.env.NODE_ENV !== 'production') {\r\n            console.error('Exception:', exception);\r\n        }\r\n\r\n        response.status(status).json({\r\n            success: false,\r\n            statusCode: status,\r\n            message,\r\n            errors,\r\n            timestamp: new Date().toISOString(),\r\n            path: request.url,\r\n        });\r\n    }\r\n}\r\n"],"names":["AllExceptionsFilter","catch","exception","host","ctx","switchToHttp","response","getResponse","request","getRequest","status","HttpStatus","INTERNAL_SERVER_ERROR","message","errors","HttpException","getStatus","exceptionResponse","responseObj","Error","process","env","NODE_ENV","console","error","json","success","statusCode","timestamp","Date","toISOString","path","url"],"mappings":";;;;+BAUaA;;;eAAAA;;;wBAJN;;;;;;;AAIA,IAAA,AAAMA,sBAAN,MAAMA;IACTC,MAAMC,SAAkB,EAAEC,IAAmB,EAAE;QAC3C,MAAMC,MAAMD,KAAKE,YAAY;QAC7B,MAAMC,WAAWF,IAAIG,WAAW;QAChC,MAAMC,UAAUJ,IAAIK,UAAU;QAE9B,IAAIC,SAASC,kBAAU,CAACC,qBAAqB;QAC7C,IAAIC,UAAU;QACd,IAAIC,SAAc;QAElB,IAAIZ,qBAAqBa,qBAAa,EAAE;YACpCL,SAASR,UAAUc,SAAS;YAC5B,MAAMC,oBAAoBf,UAAUK,WAAW;YAE/C,IAAI,OAAOU,sBAAsB,UAAU;gBACvCJ,UAAUI;YACd,OAAO,IAAI,OAAOA,sBAAsB,UAAU;gBAC9C,MAAMC,cAAcD;gBACpBJ,UAAUK,YAAYL,OAAO,IAAIA;gBACjCC,SAASI,YAAYJ,MAAM,IAAI;YACnC;QACJ,OAAO,IAAIZ,qBAAqBiB,OAAO;YACnCN,UAAUX,UAAUW,OAAO;QAC/B;QAEA,2BAA2B;QAC3B,IAAIO,QAAQC,GAAG,CAACC,QAAQ,KAAK,cAAc;YACvCC,QAAQC,KAAK,CAAC,cAActB;QAChC;QAEAI,SAASI,MAAM,CAACA,QAAQe,IAAI,CAAC;YACzBC,SAAS;YACTC,YAAYjB;YACZG;YACAC;YACAc,WAAW,IAAIC,OAAOC,WAAW;YACjCC,MAAMvB,QAAQwB,GAAG;QACrB;IACJ;AACJ"}