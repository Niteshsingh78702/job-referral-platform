{"version":3,"sources":["../src/main.ts"],"sourcesContent":["import { NestFactory } from '@nestjs/core';\r\nimport { ValidationPipe } from '@nestjs/common';\r\nimport { ConfigService } from '@nestjs/config';\r\nimport { SwaggerModule, DocumentBuilder } from '@nestjs/swagger';\r\nimport { NestExpressApplication } from '@nestjs/platform-express';\r\nimport { join } from 'path';\r\nimport { AppModule } from './app.module';\r\n\r\nasync function bootstrap() {\r\n  const app = await NestFactory.create<NestExpressApplication>(AppModule);\r\n  const configService = app.get(ConfigService);\r\n\r\n  // Serve static frontend files from /frontend folder FIRST\r\n  // Use process.cwd() which works both with ts-node and compiled code\r\n  const frontendPath = join(process.cwd(), 'frontend');\r\n  console.log('Serving static files from:', frontendPath);\r\n\r\n  app.useStaticAssets(frontendPath, {\r\n    prefix: '/',\r\n    index: 'index.html',\r\n  });\r\n\r\n  // Global prefix for API routes\r\n  const apiPrefix = configService.get('API_PREFIX', 'api/v1');\r\n  app.setGlobalPrefix(apiPrefix);\r\n\r\n  // Swagger API Documentation\r\n  const swaggerConfig = new DocumentBuilder()\r\n    .setTitle('Job Referral Platform API')\r\n    .setDescription(\r\n      'API documentation for the Job Referral & Pre-Screening Platform',\r\n    )\r\n    .setVersion('1.0')\r\n    .addBearerAuth(\r\n      {\r\n        type: 'http',\r\n        scheme: 'bearer',\r\n        bearerFormat: 'JWT',\r\n        name: 'JWT',\r\n        description: 'Enter JWT token',\r\n        in: 'header',\r\n      },\r\n      'JWT-auth',\r\n    )\r\n    .addTag('auth', 'Authentication endpoints')\r\n    .addTag('jobs', 'Job management endpoints')\r\n    .addTag('tests', 'Test & assessment endpoints')\r\n    .addTag('payments', 'Payment processing endpoints')\r\n    .addTag('referrals', 'Referral management endpoints')\r\n    .addTag('admin', 'Admin dashboard endpoints')\r\n    .addTag('candidates', 'Candidate profile endpoints')\r\n    .build();\r\n\r\n  const document = SwaggerModule.createDocument(app, swaggerConfig);\r\n  SwaggerModule.setup('api/docs', app, document);\r\n\r\n  // Validation\r\n  app.useGlobalPipes(\r\n    new ValidationPipe({\r\n      whitelist: true,\r\n      forbidNonWhitelisted: true,\r\n      transform: true,\r\n      transformOptions: {\r\n        enableImplicitConversion: true,\r\n      },\r\n    }),\r\n  );\r\n\r\n  // CORS - allow multiple origins for development\r\n  const allowedOrigins = [\r\n    'http://localhost:3000',\r\n    'http://localhost:3001',\r\n    'http://127.0.0.1:3000',\r\n    'http://127.0.0.1:3001',\r\n  ];\r\n\r\n  app.enableCors({\r\n    origin: (origin, callback) => {\r\n      // Allow requests with no origin (like mobile apps, curl, file://)\r\n      if (!origin) return callback(null, true);\r\n\r\n      if (allowedOrigins.includes(origin)) {\r\n        callback(null, true);\r\n      } else {\r\n        // For development, allow all origins\r\n        callback(null, true);\r\n      }\r\n    },\r\n    credentials: true,\r\n    methods: ['GET', 'POST', 'PUT', 'PATCH', 'DELETE', 'OPTIONS'],\r\n    allowedHeaders: [\r\n      'Content-Type',\r\n      'Authorization',\r\n      'x-device-id',\r\n      'x-razorpay-signature',\r\n    ],\r\n  });\r\n\r\n  // Start server\r\n  const port = configService.get('PORT', 3000);\r\n  await app.listen(port);\r\n\r\n  console.log(`\r\n  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—\r\n  â•‘                                                              â•‘\r\n  â•‘   ğŸš€ Job Referral Platform is running!                       â•‘\r\n  â•‘                                                              â•‘\r\n  â•‘   ğŸ“ Frontend: http://localhost:${port}                          â•‘\r\n  â•‘   ğŸ“ API: http://localhost:${port}/${apiPrefix}                  â•‘\r\n  â•‘   ğŸ“š Docs: http://localhost:${port}/api/docs                     â•‘\r\n  â•‘   ğŸ“Œ Environment: ${configService.get('NODE_ENV', 'development')}                         â•‘\r\n  â•‘                                                              â•‘\r\n  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\r\n  `);\r\n}\r\n\r\nbootstrap();\r\n"],"names":["bootstrap","app","NestFactory","create","AppModule","configService","get","ConfigService","frontendPath","join","process","cwd","console","log","useStaticAssets","prefix","index","apiPrefix","setGlobalPrefix","swaggerConfig","DocumentBuilder","setTitle","setDescription","setVersion","addBearerAuth","type","scheme","bearerFormat","name","description","in","addTag","build","document","SwaggerModule","createDocument","setup","useGlobalPipes","ValidationPipe","whitelist","forbidNonWhitelisted","transform","transformOptions","enableImplicitConversion","allowedOrigins","enableCors","origin","callback","includes","credentials","methods","allowedHeaders","port","listen"],"mappings":";;;;sBAA4B;wBACG;wBACD;yBACiB;sBAE1B;2BACK;AAE1B,eAAeA;IACb,MAAMC,MAAM,MAAMC,iBAAW,CAACC,MAAM,CAAyBC,oBAAS;IACtE,MAAMC,gBAAgBJ,IAAIK,GAAG,CAACC,qBAAa;IAE3C,0DAA0D;IAC1D,oEAAoE;IACpE,MAAMC,eAAeC,IAAAA,UAAI,EAACC,QAAQC,GAAG,IAAI;IACzCC,QAAQC,GAAG,CAAC,8BAA8BL;IAE1CP,IAAIa,eAAe,CAACN,cAAc;QAChCO,QAAQ;QACRC,OAAO;IACT;IAEA,+BAA+B;IAC/B,MAAMC,YAAYZ,cAAcC,GAAG,CAAC,cAAc;IAClDL,IAAIiB,eAAe,CAACD;IAEpB,4BAA4B;IAC5B,MAAME,gBAAgB,IAAIC,wBAAe,GACtCC,QAAQ,CAAC,6BACTC,cAAc,CACb,mEAEDC,UAAU,CAAC,OACXC,aAAa,CACZ;QACEC,MAAM;QACNC,QAAQ;QACRC,cAAc;QACdC,MAAM;QACNC,aAAa;QACbC,IAAI;IACN,GACA,YAEDC,MAAM,CAAC,QAAQ,4BACfA,MAAM,CAAC,QAAQ,4BACfA,MAAM,CAAC,SAAS,+BAChBA,MAAM,CAAC,YAAY,gCACnBA,MAAM,CAAC,aAAa,iCACpBA,MAAM,CAAC,SAAS,6BAChBA,MAAM,CAAC,cAAc,+BACrBC,KAAK;IAER,MAAMC,WAAWC,sBAAa,CAACC,cAAc,CAAClC,KAAKkB;IACnDe,sBAAa,CAACE,KAAK,CAAC,YAAYnC,KAAKgC;IAErC,aAAa;IACbhC,IAAIoC,cAAc,CAChB,IAAIC,sBAAc,CAAC;QACjBC,WAAW;QACXC,sBAAsB;QACtBC,WAAW;QACXC,kBAAkB;YAChBC,0BAA0B;QAC5B;IACF;IAGF,gDAAgD;IAChD,MAAMC,iBAAiB;QACrB;QACA;QACA;QACA;KACD;IAED3C,IAAI4C,UAAU,CAAC;QACbC,QAAQ,CAACA,QAAQC;YACf,kEAAkE;YAClE,IAAI,CAACD,QAAQ,OAAOC,SAAS,MAAM;YAEnC,IAAIH,eAAeI,QAAQ,CAACF,SAAS;gBACnCC,SAAS,MAAM;YACjB,OAAO;gBACL,qCAAqC;gBACrCA,SAAS,MAAM;YACjB;QACF;QACAE,aAAa;QACbC,SAAS;YAAC;YAAO;YAAQ;YAAO;YAAS;YAAU;SAAU;QAC7DC,gBAAgB;YACd;YACA;YACA;YACA;SACD;IACH;IAEA,eAAe;IACf,MAAMC,OAAO/C,cAAcC,GAAG,CAAC,QAAQ;IACvC,MAAML,IAAIoD,MAAM,CAACD;IAEjBxC,QAAQC,GAAG,CAAC,CAAC;;;;;oCAKqB,EAAEuC,KAAK;+BACZ,EAAEA,KAAK,CAAC,EAAEnC,UAAU;gCACnB,EAAEmC,KAAK;sBACjB,EAAE/C,cAAcC,GAAG,CAAC,YAAY,eAAe;;;EAGnE,CAAC;AACH;AAEAN"}