{"version":3,"sources":["../../../src/modules/auth/auth.controller.ts"],"sourcesContent":["import {\r\n  Controller,\r\n  Post,\r\n  Body,\r\n  Get,\r\n  Req,\r\n  HttpCode,\r\n  HttpStatus,\r\n} from '@nestjs/common';\r\nimport { AuthService } from './services';\r\nimport {\r\n  RegisterDto,\r\n  LoginDto,\r\n  SendOtpDto,\r\n  VerifyOtpDto,\r\n  RefreshTokenDto,\r\n  ResetPasswordDto,\r\n  ChangePasswordDto,\r\n  GoogleAuthDto,\r\n  ForgotPasswordDto,\r\n  ResetPasswordWithTokenDto,\r\n} from './dto';\r\nimport { Public, CurrentUser } from '../../common/decorators';\r\n\r\n@Controller('auth')\r\nexport class AuthController {\r\n  constructor(private readonly authService: AuthService) {}\r\n\r\n  @Public()\r\n  @Post('register')\r\n  @HttpCode(HttpStatus.CREATED)\r\n  async register(@Body() dto: RegisterDto, @Req() req: any) {\r\n    const deviceInfo = {\r\n      ip: req.ip || req.headers['x-forwarded-for'],\r\n      userAgent: req.headers['user-agent'],\r\n      deviceId: req.headers['x-device-id'],\r\n    };\r\n    return this.authService.register(dto, deviceInfo);\r\n  }\r\n\r\n  @Public()\r\n  @Post('login')\r\n  @HttpCode(HttpStatus.OK)\r\n  async login(@Body() dto: LoginDto, @Req() req: any) {\r\n    const deviceInfo = {\r\n      ip: req.ip || req.headers['x-forwarded-for'],\r\n      userAgent: req.headers['user-agent'],\r\n      deviceId: req.headers['x-device-id'],\r\n    };\r\n    return this.authService.login(dto, deviceInfo);\r\n  }\r\n\r\n  @Public()\r\n  @Post('google')\r\n  @HttpCode(HttpStatus.OK)\r\n  async googleLogin(@Body() dto: GoogleAuthDto, @Req() req: any) {\r\n    const deviceInfo = {\r\n      ip: req.ip || req.headers['x-forwarded-for'],\r\n      userAgent: req.headers['user-agent'],\r\n      deviceId: req.headers['x-device-id'],\r\n    };\r\n    return this.authService.googleLogin(dto, deviceInfo);\r\n  }\r\n\r\n  @Public()\r\n  @Post('send-otp')\r\n  @HttpCode(HttpStatus.OK)\r\n  async sendOtp(@Body() dto: SendOtpDto) {\r\n    return this.authService.sendOtp(dto);\r\n  }\r\n\r\n  @Public()\r\n  @Post('verify-otp')\r\n  @HttpCode(HttpStatus.OK)\r\n  async verifyOtp(@Body() dto: VerifyOtpDto) {\r\n    return this.authService.verifyOtp(dto);\r\n  }\r\n\r\n  @Public()\r\n  @Post('refresh')\r\n  @HttpCode(HttpStatus.OK)\r\n  async refreshToken(@Body() dto: RefreshTokenDto) {\r\n    return this.authService.refreshToken(dto);\r\n  }\r\n\r\n  @Post('logout')\r\n  @HttpCode(HttpStatus.OK)\r\n  async logout(@CurrentUser('sub') userId: string) {\r\n    return this.authService.logout(userId);\r\n  }\r\n\r\n  @Public()\r\n  @Post('forgot-password')\r\n  @HttpCode(HttpStatus.OK)\r\n  async forgotPassword(@Body() dto: ForgotPasswordDto) {\r\n    return this.authService.forgotPassword(dto);\r\n  }\r\n\r\n  @Public()\r\n  @Post('reset-password')\r\n  @HttpCode(HttpStatus.OK)\r\n  async resetPassword(@Body() dto: ResetPasswordDto) {\r\n    return this.authService.resetPassword(dto);\r\n  }\r\n\r\n  @Public()\r\n  @Post('reset-password-with-token')\r\n  @HttpCode(HttpStatus.OK)\r\n  async resetPasswordWithToken(@Body() dto: ResetPasswordWithTokenDto) {\r\n    return this.authService.resetPasswordWithToken(dto);\r\n  }\r\n\r\n  @Post('change-password')\r\n  @HttpCode(HttpStatus.OK)\r\n  async changePassword(\r\n    @CurrentUser('sub') userId: string,\r\n    @Body() dto: ChangePasswordDto,\r\n  ) {\r\n    return this.authService.changePassword(userId, dto);\r\n  }\r\n\r\n  @Get('me')\r\n  async getCurrentUser(@CurrentUser('sub') userId: string) {\r\n    return this.authService.getCurrentUser(userId);\r\n  }\r\n}\r\n"],"names":["AuthController","register","dto","req","deviceInfo","ip","headers","userAgent","deviceId","authService","login","googleLogin","sendOtp","verifyOtp","refreshToken","logout","userId","forgotPassword","resetPassword","resetPasswordWithToken","changePassword","getCurrentUser","CREATED","OK"],"mappings":";;;;+BAyBaA;;;eAAAA;;;wBAjBN;0BACqB;qBAYrB;4BAC6B;;;;;;;;;;;;;;;AAG7B,IAAA,AAAMA,iBAAN,MAAMA;IAGX,MAGMC,SAAS,AAAQC,GAAgB,EAAE,AAAOC,GAAQ,EAAE;QACxD,MAAMC,aAAa;YACjBC,IAAIF,IAAIE,EAAE,IAAIF,IAAIG,OAAO,CAAC,kBAAkB;YAC5CC,WAAWJ,IAAIG,OAAO,CAAC,aAAa;YACpCE,UAAUL,IAAIG,OAAO,CAAC,cAAc;QACtC;QACA,OAAO,IAAI,CAACG,WAAW,CAACR,QAAQ,CAACC,KAAKE;IACxC;IAEA,MAGMM,MAAM,AAAQR,GAAa,EAAE,AAAOC,GAAQ,EAAE;QAClD,MAAMC,aAAa;YACjBC,IAAIF,IAAIE,EAAE,IAAIF,IAAIG,OAAO,CAAC,kBAAkB;YAC5CC,WAAWJ,IAAIG,OAAO,CAAC,aAAa;YACpCE,UAAUL,IAAIG,OAAO,CAAC,cAAc;QACtC;QACA,OAAO,IAAI,CAACG,WAAW,CAACC,KAAK,CAACR,KAAKE;IACrC;IAEA,MAGMO,YAAY,AAAQT,GAAkB,EAAE,AAAOC,GAAQ,EAAE;QAC7D,MAAMC,aAAa;YACjBC,IAAIF,IAAIE,EAAE,IAAIF,IAAIG,OAAO,CAAC,kBAAkB;YAC5CC,WAAWJ,IAAIG,OAAO,CAAC,aAAa;YACpCE,UAAUL,IAAIG,OAAO,CAAC,cAAc;QACtC;QACA,OAAO,IAAI,CAACG,WAAW,CAACE,WAAW,CAACT,KAAKE;IAC3C;IAEA,MAGMQ,QAAQ,AAAQV,GAAe,EAAE;QACrC,OAAO,IAAI,CAACO,WAAW,CAACG,OAAO,CAACV;IAClC;IAEA,MAGMW,UAAU,AAAQX,GAAiB,EAAE;QACzC,OAAO,IAAI,CAACO,WAAW,CAACI,SAAS,CAACX;IACpC;IAEA,MAGMY,aAAa,AAAQZ,GAAoB,EAAE;QAC/C,OAAO,IAAI,CAACO,WAAW,CAACK,YAAY,CAACZ;IACvC;IAEA,MAEMa,OAAO,AAAoBC,MAAc,EAAE;QAC/C,OAAO,IAAI,CAACP,WAAW,CAACM,MAAM,CAACC;IACjC;IAEA,MAGMC,eAAe,AAAQf,GAAsB,EAAE;QACnD,OAAO,IAAI,CAACO,WAAW,CAACQ,cAAc,CAACf;IACzC;IAEA,MAGMgB,cAAc,AAAQhB,GAAqB,EAAE;QACjD,OAAO,IAAI,CAACO,WAAW,CAACS,aAAa,CAAChB;IACxC;IAEA,MAGMiB,uBAAuB,AAAQjB,GAA8B,EAAE;QACnE,OAAO,IAAI,CAACO,WAAW,CAACU,sBAAsB,CAACjB;IACjD;IAEA,MAEMkB,eACJ,AAAoBJ,MAAc,EAClC,AAAQd,GAAsB,EAC9B;QACA,OAAO,IAAI,CAACO,WAAW,CAACW,cAAc,CAACJ,QAAQd;IACjD;IAEA,MACMmB,eAAe,AAAoBL,MAAc,EAAE;QACvD,OAAO,IAAI,CAACP,WAAW,CAACY,cAAc,CAACL;IACzC;IAlGA,YAAY,AAAiBP,WAAwB,CAAE;aAA1BA,cAAAA;IAA2B;AAmG1D;;;;6CA/FuBa;;;;;;;;;;;;;6CAYAC;;;;;;;;;;;;;6CAYAA;;;;;;;;;;;;;6CAYAA;;;;;;;;;;;6CAOAA;;;;;;;;;;;6CAOAA;;;;;;;;;;6CAMAA;;;;;;;;;;;6CAOAA;;;;;;;;;;;6CAOAA;;;;;;;;;;;6CAOAA;;;;;;;;;;6CAMAA"}