{"version":3,"sources":["../../../src/modules/interview/interview.controller.ts"],"sourcesContent":["import {\r\n    Controller,\r\n    Post,\r\n    Get,\r\n    Body,\r\n    Param,\r\n    Query,\r\n    UseGuards,\r\n    HttpCode,\r\n    HttpStatus,\r\n} from '@nestjs/common';\r\nimport { InterviewService } from './interview.service';\r\nimport { ConfirmInterviewDto } from './dto';\r\nimport { CurrentUser, Roles } from '../../common/decorators';\r\nimport { RolesGuard } from '../../common/guards';\r\nimport { UserRole } from '../../common/constants';\r\n\r\n@Controller('interviews')\r\nexport class InterviewController {\r\n    constructor(private readonly interviewService: InterviewService) { }\r\n\r\n    // ===========================================\r\n    // HR Endpoints\r\n    // ===========================================\r\n\r\n    /**\r\n     * HR confirms an interview with date/time/mode.\r\n     * NEW FLOW: HR provides all details upfront, candidate pays to unlock.\r\n     */\r\n    @Post('confirm/:applicationId')\r\n    @UseGuards(RolesGuard)\r\n    @Roles(UserRole.HR)\r\n    @HttpCode(HttpStatus.CREATED)\r\n    async confirmInterview(\r\n        @CurrentUser('sub') userId: string,\r\n        @Param('applicationId') applicationId: string,\r\n        @Body() dto: ConfirmInterviewDto,\r\n    ) {\r\n        return this.interviewService.confirmInterview(userId, applicationId, dto);\r\n    }\r\n\r\n    /**\r\n     * HR schedules interview after candidate has paid\r\n     * Sets date, time, meeting link, and additional details\r\n     */\r\n    @Post('schedule/:interviewId')\r\n    @UseGuards(RolesGuard)\r\n    @Roles(UserRole.HR)\r\n    @HttpCode(HttpStatus.OK)\r\n    async scheduleInterview(\r\n        @CurrentUser('sub') userId: string,\r\n        @Param('interviewId') interviewId: string,\r\n        @Body() dto: { scheduledDate: string; scheduledTime: string; interviewLink?: string; callDetails?: string },\r\n    ) {\r\n        return this.interviewService.scheduleInterview(userId, interviewId, dto);\r\n    }\r\n\r\n    /**\r\n     * Get all interviews for HR's jobs\r\n     */\r\n    @Get('hr')\r\n    @UseGuards(RolesGuard)\r\n    @Roles(UserRole.HR)\r\n    async getHRInterviews(\r\n        @CurrentUser('sub') userId: string,\r\n        @Query('status') status?: string,\r\n        @Query('jobId') jobId?: string,\r\n    ) {\r\n        return this.interviewService.getHRInterviews(userId, { status, jobId });\r\n    }\r\n\r\n    // ===========================================\r\n    // Candidate Endpoints\r\n    // ===========================================\r\n\r\n    /**\r\n     * Get all interviews for candidate\r\n     */\r\n    @Get('candidate')\r\n    @UseGuards(RolesGuard)\r\n    @Roles(UserRole.CANDIDATE)\r\n    async getCandidateInterviews(@CurrentUser('sub') userId: string) {\r\n        return this.interviewService.getCandidateInterviews(userId);\r\n    }\r\n\r\n    /**\r\n     * Get specific interview for candidate\r\n     * Returns filtered data based on interview status\r\n     */\r\n    @Get('candidate/:interviewId')\r\n    @UseGuards(RolesGuard)\r\n    @Roles(UserRole.CANDIDATE)\r\n    async getInterviewForCandidate(\r\n        @CurrentUser('sub') userId: string,\r\n        @Param('interviewId') interviewId: string,\r\n    ) {\r\n        return this.interviewService.getInterviewForCandidate(userId, interviewId);\r\n    }\r\n\r\n    // ===========================================\r\n    // Admin Endpoints\r\n    // ===========================================\r\n\r\n    /**\r\n     * Get interview statistics for admin dashboard\r\n     */\r\n    @Get('admin/stats')\r\n    @UseGuards(RolesGuard)\r\n    @Roles(UserRole.ADMIN)\r\n    async getAdminStats() {\r\n        return this.interviewService.getAdminInterviewStats();\r\n    }\r\n\r\n    /**\r\n     * Get all interviews for admin with pagination\r\n     */\r\n    @Get('admin')\r\n    @UseGuards(RolesGuard)\r\n    @Roles(UserRole.ADMIN)\r\n    async getAdminInterviews(\r\n        @Query('page') page?: number,\r\n        @Query('limit') limit?: number,\r\n        @Query('status') status?: string,\r\n    ) {\r\n        return this.interviewService.getAdminInterviews(page || 1, limit || 20, status);\r\n    }\r\n\r\n    /**\r\n     * Admin marks interview as no-show (candidate or HR)\r\n     */\r\n    @Post('admin/:interviewId/no-show')\r\n    @UseGuards(RolesGuard)\r\n    @Roles(UserRole.ADMIN)\r\n    async markNoShow(\r\n        @CurrentUser('sub') adminUserId: string,\r\n        @Param('interviewId') interviewId: string,\r\n        @Body('type') type: 'CANDIDATE' | 'HR',\r\n    ) {\r\n        return this.interviewService.markNoShow(interviewId, type, adminUserId);\r\n    }\r\n\r\n    /**\r\n     * Admin marks interview as completed\r\n     */\r\n    @Post('admin/:interviewId/complete')\r\n    @UseGuards(RolesGuard)\r\n    @Roles(UserRole.ADMIN)\r\n    async markCompleted(\r\n        @CurrentUser('sub') adminUserId: string,\r\n        @Param('interviewId') interviewId: string,\r\n    ) {\r\n        return this.interviewService.markCompleted(interviewId, adminUserId);\r\n    }\r\n\r\n    /**\r\n     * HR marks interview outcome (Selected/Not Selected/No Show)\r\n     */\r\n    @Post(':interviewId/outcome')\r\n    @UseGuards(RolesGuard)\r\n    @Roles(UserRole.HR)\r\n    @HttpCode(HttpStatus.OK)\r\n    async markInterviewOutcome(\r\n        @CurrentUser('sub') userId: string,\r\n        @Param('interviewId') interviewId: string,\r\n        @Body() dto: { outcome: 'SELECTED' | 'NOT_SELECTED' | 'CANDIDATE_NO_SHOW'; notes?: string; applicationId?: string },\r\n    ) {\r\n        return this.interviewService.markInterviewOutcome(userId, interviewId, dto);\r\n    }\r\n}\r\n"],"names":["InterviewController","confirmInterview","userId","applicationId","dto","interviewService","scheduleInterview","interviewId","getHRInterviews","status","jobId","getCandidateInterviews","getInterviewForCandidate","getAdminStats","getAdminInterviewStats","getAdminInterviews","page","limit","markNoShow","adminUserId","type","markCompleted","markInterviewOutcome","HR","CREATED","OK","CANDIDATE","ADMIN"],"mappings":";;;;+BAkBaA;;;eAAAA;;;wBARN;kCAC0B;qBACG;4BACD;wBACR;2BACF;;;;;;;;;;;;;;;AAGlB,IAAA,AAAMA,sBAAN,MAAMA;IAGT,8CAA8C;IAC9C,eAAe;IACf,8CAA8C;IAE9C;;;KAGC,GACD,MAIMC,iBACF,AAAoBC,MAAc,EAClC,AAAwBC,aAAqB,EAC7C,AAAQC,GAAwB,EAClC;QACE,OAAO,IAAI,CAACC,gBAAgB,CAACJ,gBAAgB,CAACC,QAAQC,eAAeC;IACzE;IAEA;;;KAGC,GACD,MAIME,kBACF,AAAoBJ,MAAc,EAClC,AAAsBK,WAAmB,EACzC,AAAQH,GAAmG,EAC7G;QACE,OAAO,IAAI,CAACC,gBAAgB,CAACC,iBAAiB,CAACJ,QAAQK,aAAaH;IACxE;IAEA;;KAEC,GACD,MAGMI,gBACF,AAAoBN,MAAc,EAClC,AAAiBO,MAAe,EAChC,AAAgBC,KAAc,EAChC;QACE,OAAO,IAAI,CAACL,gBAAgB,CAACG,eAAe,CAACN,QAAQ;YAAEO;YAAQC;QAAM;IACzE;IAEA,8CAA8C;IAC9C,sBAAsB;IACtB,8CAA8C;IAE9C;;KAEC,GACD,MAGMC,uBAAuB,AAAoBT,MAAc,EAAE;QAC7D,OAAO,IAAI,CAACG,gBAAgB,CAACM,sBAAsB,CAACT;IACxD;IAEA;;;KAGC,GACD,MAGMU,yBACF,AAAoBV,MAAc,EAClC,AAAsBK,WAAmB,EAC3C;QACE,OAAO,IAAI,CAACF,gBAAgB,CAACO,wBAAwB,CAACV,QAAQK;IAClE;IAEA,8CAA8C;IAC9C,kBAAkB;IAClB,8CAA8C;IAE9C;;KAEC,GACD,MAGMM,gBAAgB;QAClB,OAAO,IAAI,CAACR,gBAAgB,CAACS,sBAAsB;IACvD;IAEA;;KAEC,GACD,MAGMC,mBACF,AAAeC,IAAa,EAC5B,AAAgBC,KAAc,EAC9B,AAAiBR,MAAe,EAClC;QACE,OAAO,IAAI,CAACJ,gBAAgB,CAACU,kBAAkB,CAACC,QAAQ,GAAGC,SAAS,IAAIR;IAC5E;IAEA;;KAEC,GACD,MAGMS,WACF,AAAoBC,WAAmB,EACvC,AAAsBZ,WAAmB,EACzC,AAAca,IAAwB,EACxC;QACE,OAAO,IAAI,CAACf,gBAAgB,CAACa,UAAU,CAACX,aAAaa,MAAMD;IAC/D;IAEA;;KAEC,GACD,MAGME,cACF,AAAoBF,WAAmB,EACvC,AAAsBZ,WAAmB,EAC3C;QACE,OAAO,IAAI,CAACF,gBAAgB,CAACgB,aAAa,CAACd,aAAaY;IAC5D;IAEA;;KAEC,GACD,MAIMG,qBACF,AAAoBpB,MAAc,EAClC,AAAsBK,WAAmB,EACzC,AAAQH,GAA2G,EACrH;QACE,OAAO,IAAI,CAACC,gBAAgB,CAACiB,oBAAoB,CAACpB,QAAQK,aAAaH;IAC3E;IApJA,YAAY,AAAiBC,gBAAkC,CAAE;aAApCA,mBAAAA;IAAsC;AAqJvE;;;;+CAzIoBkB;6CACKC;;;;;;;;;;;;;;;+CAeLD;6CACKE;;;;;;;;;;;;;;;+CAcLF;;;;;;;;;;;;;;;+CAkBAG;;;;;;;;;;;+CAWAA;;;;;;;;;;;;;+CAiBAC;;;;;;;;+CAUAA;;;;;;;;;;;;;;;+CAcAA;;;;;;;;;;;;;;;+CAcAA;;;;;;;;;;;;;+CAaAJ;6CACKE"}