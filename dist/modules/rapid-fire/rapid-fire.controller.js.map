{"version":3,"sources":["../../../src/modules/rapid-fire/rapid-fire.controller.ts"],"sourcesContent":["import {\r\n    Controller,\r\n    Get,\r\n    Post,\r\n    Body,\r\n    Param,\r\n    UseGuards,\r\n} from '@nestjs/common';\r\nimport { JwtAuthGuard } from '../../common/guards/jwt-auth.guard';\r\nimport { RolesGuard } from '../../common/guards/roles.guard';\r\nimport { Roles } from '../../common/decorators/roles.decorator';\r\nimport { CurrentUser } from '../../common/decorators/current-user.decorator';\r\nimport { UserRole } from '../../common/constants';\r\nimport { RapidFireTestService } from './rapid-fire.service';\r\n\r\n@Controller('rapid-fire')\r\n@UseGuards(JwtAuthGuard, RolesGuard)\r\nexport class RapidFireController {\r\n    constructor(private rapidFireService: RapidFireTestService) { }\r\n\r\n    /**\r\n     * Check if candidate can take a test for a skill bucket\r\n     */\r\n    @Get('eligibility/:skillBucketId')\r\n    @Roles(UserRole.CANDIDATE)\r\n    async checkEligibility(\r\n        @Param('skillBucketId') skillBucketId: string,\r\n        @CurrentUser() user: any,\r\n    ) {\r\n        // Get candidate from user\r\n        const eligibility = await this.rapidFireService.canTakeTest(user.candidateId, skillBucketId);\r\n        return {\r\n            success: true,\r\n            data: eligibility,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Start a rapid fire test\r\n     */\r\n    @Post('start/:skillBucketId')\r\n    @Roles(UserRole.CANDIDATE)\r\n    async startTest(\r\n        @Param('skillBucketId') skillBucketId: string,\r\n        @CurrentUser() user: any,\r\n    ) {\r\n        const result = await this.rapidFireService.startTest(user.sub, user.candidateId, skillBucketId);\r\n        return {\r\n            success: true,\r\n            message: 'Test started! Good luck!',\r\n            data: result,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Get current test state with all questions\r\n     */\r\n    @Get('session/:sessionId')\r\n    @Roles(UserRole.CANDIDATE)\r\n    async getTestState(\r\n        @Param('sessionId') sessionId: string,\r\n        @CurrentUser() user: any,\r\n    ) {\r\n        const state = await this.rapidFireService.getTestState(sessionId, user.sub);\r\n        return {\r\n            success: true,\r\n            data: state,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Submit answer for a question\r\n     */\r\n    @Post('session/:sessionId/answer')\r\n    @Roles(UserRole.CANDIDATE)\r\n    async submitAnswer(\r\n        @Param('sessionId') sessionId: string,\r\n        @Body() body: { questionId: string; selectedAnswer: number },\r\n        @CurrentUser() user: any,\r\n    ) {\r\n        const result = await this.rapidFireService.submitAnswer(\r\n            sessionId,\r\n            user.sub,\r\n            body.questionId,\r\n            body.selectedAnswer,\r\n        );\r\n        return {\r\n            success: true,\r\n            data: result,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Submit the entire test\r\n     */\r\n    @Post('session/:sessionId/submit')\r\n    @Roles(UserRole.CANDIDATE)\r\n    async submitTest(\r\n        @Param('sessionId') sessionId: string,\r\n        @CurrentUser() user: any,\r\n    ) {\r\n        const result = await this.rapidFireService.submitTest(sessionId, user.sub);\r\n        return {\r\n            success: true,\r\n            data: result,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Exit test (marks as failed)\r\n     */\r\n    @Post('session/:sessionId/exit')\r\n    @Roles(UserRole.CANDIDATE)\r\n    async exitTest(\r\n        @Param('sessionId') sessionId: string,\r\n        @CurrentUser() user: any,\r\n    ) {\r\n        const result = await this.rapidFireService.exitTest(sessionId, user.sub);\r\n        return {\r\n            success: true,\r\n            data: result,\r\n        };\r\n    }\r\n\r\n    /**\r\n     * Get test history for current candidate\r\n     */\r\n    @Get('history')\r\n    @Roles(UserRole.CANDIDATE)\r\n    async getTestHistory(@CurrentUser() user: any) {\r\n        const history = await this.rapidFireService.getTestHistory(user.candidateId);\r\n        return {\r\n            success: true,\r\n            data: history,\r\n        };\r\n    }\r\n}\r\n"],"names":["RapidFireController","checkEligibility","skillBucketId","user","eligibility","rapidFireService","canTakeTest","candidateId","success","data","startTest","result","sub","message","getTestState","sessionId","state","submitAnswer","body","questionId","selectedAnswer","submitTest","exitTest","getTestHistory","history","CANDIDATE"],"mappings":";;;;+BAiBaA;;;eAAAA;;;wBAVN;8BACsB;4BACF;gCACL;sCACM;2BACH;kCACY;;;;;;;;;;;;;;;AAI9B,IAAA,AAAMA,sBAAN,MAAMA;IAGT;;KAEC,GACD,MAEMC,iBACF,AAAwBC,aAAqB,EAC7C,AAAeC,IAAS,EAC1B;QACE,0BAA0B;QAC1B,MAAMC,cAAc,MAAM,IAAI,CAACC,gBAAgB,CAACC,WAAW,CAACH,KAAKI,WAAW,EAAEL;QAC9E,OAAO;YACHM,SAAS;YACTC,MAAML;QACV;IACJ;IAEA;;KAEC,GACD,MAEMM,UACF,AAAwBR,aAAqB,EAC7C,AAAeC,IAAS,EAC1B;QACE,MAAMQ,SAAS,MAAM,IAAI,CAACN,gBAAgB,CAACK,SAAS,CAACP,KAAKS,GAAG,EAAET,KAAKI,WAAW,EAAEL;QACjF,OAAO;YACHM,SAAS;YACTK,SAAS;YACTJ,MAAME;QACV;IACJ;IAEA;;KAEC,GACD,MAEMG,aACF,AAAoBC,SAAiB,EACrC,AAAeZ,IAAS,EAC1B;QACE,MAAMa,QAAQ,MAAM,IAAI,CAACX,gBAAgB,CAACS,YAAY,CAACC,WAAWZ,KAAKS,GAAG;QAC1E,OAAO;YACHJ,SAAS;YACTC,MAAMO;QACV;IACJ;IAEA;;KAEC,GACD,MAEMC,aACF,AAAoBF,SAAiB,EACrC,AAAQG,IAAoD,EAC5D,AAAef,IAAS,EAC1B;QACE,MAAMQ,SAAS,MAAM,IAAI,CAACN,gBAAgB,CAACY,YAAY,CACnDF,WACAZ,KAAKS,GAAG,EACRM,KAAKC,UAAU,EACfD,KAAKE,cAAc;QAEvB,OAAO;YACHZ,SAAS;YACTC,MAAME;QACV;IACJ;IAEA;;KAEC,GACD,MAEMU,WACF,AAAoBN,SAAiB,EACrC,AAAeZ,IAAS,EAC1B;QACE,MAAMQ,SAAS,MAAM,IAAI,CAACN,gBAAgB,CAACgB,UAAU,CAACN,WAAWZ,KAAKS,GAAG;QACzE,OAAO;YACHJ,SAAS;YACTC,MAAME;QACV;IACJ;IAEA;;KAEC,GACD,MAEMW,SACF,AAAoBP,SAAiB,EACrC,AAAeZ,IAAS,EAC1B;QACE,MAAMQ,SAAS,MAAM,IAAI,CAACN,gBAAgB,CAACiB,QAAQ,CAACP,WAAWZ,KAAKS,GAAG;QACvE,OAAO;YACHJ,SAAS;YACTC,MAAME;QACV;IACJ;IAEA;;KAEC,GACD,MAEMY,eAAe,AAAepB,IAAS,EAAE;QAC3C,MAAMqB,UAAU,MAAM,IAAI,CAACnB,gBAAgB,CAACkB,cAAc,CAACpB,KAAKI,WAAW;QAC3E,OAAO;YACHC,SAAS;YACTC,MAAMe;QACV;IACJ;IArHA,YAAY,AAAQnB,gBAAsC,CAAE;aAAxCA,mBAAAA;IAA0C;AAsHlE;;;mDAhHoBoB;;;;;;;;;;;;mDAiBAA;;;;;;;;;;;;mDAiBAA;;;;;;;;;;;;mDAgBAA;;;;;;;;;;;;;;mDAsBAA;;;;;;;;;;;;mDAgBAA;;;;;;;;;;;;mDAgBAA"}