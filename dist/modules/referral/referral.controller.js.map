{"version":3,"sources":["../../../src/modules/referral/referral.controller.ts"],"sourcesContent":["import {\r\n    Controller,\r\n    Get,\r\n    Post,\r\n    Patch,\r\n    Body,\r\n    Param,\r\n} from '@nestjs/common';\r\nimport { ReferralService } from './referral.service';\r\nimport { ConfirmReferralDto, UpdateReferralStatusDto } from './dto';\r\nimport { CurrentUser, Roles } from '../../common/decorators';\r\nimport { UserRole } from '../../common/constants';\r\n\r\n@Controller('referrals')\r\nexport class ReferralController {\r\n    constructor(private readonly referralService: ReferralService) { }\r\n\r\n    @Get('pending/hr')\r\n    @Roles(UserRole.HR)\r\n    async getPendingForHR(@CurrentUser('sub') userId: string) {\r\n        return this.referralService.getPendingReferralsForHR(userId);\r\n    }\r\n\r\n    @Get('pending/employee')\r\n    @Roles(UserRole.EMPLOYEE)\r\n    async getPendingForEmployee(@CurrentUser('sub') userId: string) {\r\n        return this.referralService.getPendingReferralsForEmployee(userId);\r\n    }\r\n\r\n    @Post(':id/confirm')\r\n    @Roles(UserRole.HR, UserRole.EMPLOYEE)\r\n    async confirmReferral(\r\n        @Param('id') referralId: string,\r\n        @CurrentUser('sub') userId: string,\r\n        @CurrentUser('role') userRole: string,\r\n        @Body() dto: ConfirmReferralDto,\r\n    ) {\r\n        return this.referralService.confirmReferral(\r\n            referralId,\r\n            userId,\r\n            userRole,\r\n            dto,\r\n        );\r\n    }\r\n\r\n    @Patch(':id/contacted')\r\n    @Roles(UserRole.HR)\r\n    async markAsContacted(\r\n        @Param('id') referralId: string,\r\n        @CurrentUser('sub') userId: string,\r\n        @Body('feedback') feedback?: string,\r\n    ) {\r\n        return this.referralService.markAsContacted(referralId, userId, feedback);\r\n    }\r\n\r\n    @Patch(':id/close')\r\n    @Roles(UserRole.HR)\r\n    async closeReferral(\r\n        @Param('id') referralId: string,\r\n        @CurrentUser('sub') userId: string,\r\n        @Body('feedback') feedback?: string,\r\n    ) {\r\n        return this.referralService.closeReferral(referralId, userId, feedback);\r\n    }\r\n\r\n    @Get('history')\r\n    @Roles(UserRole.HR, UserRole.EMPLOYEE)\r\n    async getReferralHistory(\r\n        @CurrentUser('sub') userId: string,\r\n        @CurrentUser('role') userRole: string,\r\n    ) {\r\n        return this.referralService.getReferralHistory(userId, userRole);\r\n    }\r\n}\r\n"],"names":["ReferralController","getPendingForHR","userId","referralService","getPendingReferralsForHR","getPendingForEmployee","getPendingReferralsForEmployee","confirmReferral","referralId","userRole","dto","markAsContacted","feedback","closeReferral","getReferralHistory","HR","EMPLOYEE"],"mappings":";;;;+BAcaA;;;eAAAA;;;wBAPN;iCACyB;qBAC4B;4BACzB;2BACV;;;;;;;;;;;;;;;AAGlB,IAAA,AAAMA,qBAAN,MAAMA;IAGT,MAEMC,gBAAgB,AAAoBC,MAAc,EAAE;QACtD,OAAO,IAAI,CAACC,eAAe,CAACC,wBAAwB,CAACF;IACzD;IAEA,MAEMG,sBAAsB,AAAoBH,MAAc,EAAE;QAC5D,OAAO,IAAI,CAACC,eAAe,CAACG,8BAA8B,CAACJ;IAC/D;IAEA,MAEMK,gBACF,AAAaC,UAAkB,EAC/B,AAAoBN,MAAc,EAClC,AAAqBO,QAAgB,EACrC,AAAQC,GAAuB,EACjC;QACE,OAAO,IAAI,CAACP,eAAe,CAACI,eAAe,CACvCC,YACAN,QACAO,UACAC;IAER;IAEA,MAEMC,gBACF,AAAaH,UAAkB,EAC/B,AAAoBN,MAAc,EAClC,AAAkBU,QAAiB,EACrC;QACE,OAAO,IAAI,CAACT,eAAe,CAACQ,eAAe,CAACH,YAAYN,QAAQU;IACpE;IAEA,MAEMC,cACF,AAAaL,UAAkB,EAC/B,AAAoBN,MAAc,EAClC,AAAkBU,QAAiB,EACrC;QACE,OAAO,IAAI,CAACT,eAAe,CAACU,aAAa,CAACL,YAAYN,QAAQU;IAClE;IAEA,MAEME,mBACF,AAAoBZ,MAAc,EAClC,AAAqBO,QAAgB,EACvC;QACE,OAAO,IAAI,CAACN,eAAe,CAACW,kBAAkB,CAACZ,QAAQO;IAC3D;IAzDA,YAAY,AAAiBN,eAAgC,CAAE;aAAlCA,kBAAAA;IAAoC;AA0DrE;;;+CAvDoBY;;;;;;;;;;+CAMAC;;;;;;;;;;+CAMAD,wBAAaC;;;;;;;;;;;;;;;;+CAgBbD;;;;;;;;;;;;;;+CAUAA;;;;;;;;;;;;;;+CAUAA,wBAAaC"}