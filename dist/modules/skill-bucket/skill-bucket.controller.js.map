{"version":3,"sources":["../../../src/modules/skill-bucket/skill-bucket.controller.ts"],"sourcesContent":["import {\r\n  Controller,\r\n  Get,\r\n  Post,\r\n  Put,\r\n  Body,\r\n  Param,\r\n  Query,\r\n  UseGuards,\r\n} from '@nestjs/common';\r\nimport { SkillBucketService } from './skill-bucket.service';\r\nimport { CreateSkillBucketDto, UpdateSkillBucketDto } from './dto';\r\nimport { JwtAuthGuard } from '../../common/guards/jwt-auth.guard';\r\nimport { RolesGuard } from '../../common/guards/roles.guard';\r\nimport { Roles } from '../../common/decorators/roles.decorator';\r\nimport { CurrentUser } from '../../common/decorators/current-user.decorator';\r\nimport { UserRole } from '../../common/constants';\r\n\r\n@Controller('skill-buckets')\r\nexport class SkillBucketController {\r\n  constructor(private readonly skillBucketService: SkillBucketService) {}\r\n\r\n  // ==========================================\r\n  // PUBLIC: List skill buckets\r\n  // ==========================================\r\n\r\n  @Get()\r\n  async getSkillBuckets(@Query('includeInactive') includeInactive?: string) {\r\n    const buckets = await this.skillBucketService.getSkillBuckets(\r\n      includeInactive === 'true',\r\n    );\r\n    return {\r\n      success: true,\r\n      data: buckets,\r\n    };\r\n  }\r\n\r\n  @Get(':id')\r\n  async getSkillBucketById(@Param('id') id: string) {\r\n    const bucket = await this.skillBucketService.getSkillBucketById(id);\r\n    return {\r\n      success: true,\r\n      data: bucket,\r\n    };\r\n  }\r\n\r\n  // ==========================================\r\n  // ADMIN: Skill bucket management\r\n  // ==========================================\r\n\r\n  @Post()\r\n  @UseGuards(JwtAuthGuard, RolesGuard)\r\n  @Roles(UserRole.ADMIN)\r\n  async createSkillBucket(@Body() dto: CreateSkillBucketDto) {\r\n    const bucket = await this.skillBucketService.createSkillBucket(dto);\r\n    return {\r\n      success: true,\r\n      message: 'Skill bucket created successfully',\r\n      data: bucket,\r\n    };\r\n  }\r\n\r\n  @Put(':id')\r\n  @UseGuards(JwtAuthGuard, RolesGuard)\r\n  @Roles(UserRole.ADMIN)\r\n  async updateSkillBucket(\r\n    @Param('id') id: string,\r\n    @Body() dto: UpdateSkillBucketDto,\r\n  ) {\r\n    const bucket = await this.skillBucketService.updateSkillBucket(id, dto);\r\n    return {\r\n      success: true,\r\n      message: 'Skill bucket updated successfully',\r\n      data: bucket,\r\n    };\r\n  }\r\n\r\n  // ==========================================\r\n  // CANDIDATE: Skill test status\r\n  // ==========================================\r\n\r\n  @Get(':id/status')\r\n  @UseGuards(JwtAuthGuard)\r\n  async getSkillStatus(\r\n    @Param('id') skillBucketId: string,\r\n    @CurrentUser('candidateId') candidateId: string,\r\n  ) {\r\n    if (!candidateId) {\r\n      return {\r\n        success: false,\r\n        message: 'Candidate profile not found',\r\n      };\r\n    }\r\n\r\n    const status = await this.skillBucketService.checkCandidateSkillStatus(\r\n      candidateId,\r\n      skillBucketId,\r\n    );\r\n\r\n    return {\r\n      success: true,\r\n      data: status,\r\n    };\r\n  }\r\n\r\n  @Get('candidate/valid-passes')\r\n  @UseGuards(JwtAuthGuard)\r\n  async getValidPasses(@CurrentUser('candidateId') candidateId: string) {\r\n    if (!candidateId) {\r\n      return {\r\n        success: true,\r\n        data: [],\r\n      };\r\n    }\r\n\r\n    const passes =\r\n      await this.skillBucketService.getCandidateValidPasses(candidateId);\r\n    return {\r\n      success: true,\r\n      data: passes,\r\n    };\r\n  }\r\n}\r\n"],"names":["SkillBucketController","getSkillBuckets","includeInactive","buckets","skillBucketService","success","data","getSkillBucketById","id","bucket","createSkillBucket","dto","message","updateSkillBucket","getSkillStatus","skillBucketId","candidateId","status","checkCandidateSkillStatus","getValidPasses","passes","getCandidateValidPasses","ADMIN"],"mappings":";;;;+BAmBaA;;;eAAAA;;;wBAVN;oCAC4B;qBACwB;8BAC9B;4BACF;gCACL;sCACM;2BACH;;;;;;;;;;;;;;;AAGlB,IAAA,AAAMA,wBAAN,MAAMA;IAGX,6CAA6C;IAC7C,6BAA6B;IAC7B,6CAA6C;IAE7C,MACMC,gBAAgB,AAA0BC,eAAwB,EAAE;QACxE,MAAMC,UAAU,MAAM,IAAI,CAACC,kBAAkB,CAACH,eAAe,CAC3DC,oBAAoB;QAEtB,OAAO;YACLG,SAAS;YACTC,MAAMH;QACR;IACF;IAEA,MACMI,mBAAmB,AAAaC,EAAU,EAAE;QAChD,MAAMC,SAAS,MAAM,IAAI,CAACL,kBAAkB,CAACG,kBAAkB,CAACC;QAChE,OAAO;YACLH,SAAS;YACTC,MAAMG;QACR;IACF;IAEA,6CAA6C;IAC7C,iCAAiC;IACjC,6CAA6C;IAE7C,MAGMC,kBAAkB,AAAQC,GAAyB,EAAE;QACzD,MAAMF,SAAS,MAAM,IAAI,CAACL,kBAAkB,CAACM,iBAAiB,CAACC;QAC/D,OAAO;YACLN,SAAS;YACTO,SAAS;YACTN,MAAMG;QACR;IACF;IAEA,MAGMI,kBACJ,AAAaL,EAAU,EACvB,AAAQG,GAAyB,EACjC;QACA,MAAMF,SAAS,MAAM,IAAI,CAACL,kBAAkB,CAACS,iBAAiB,CAACL,IAAIG;QACnE,OAAO;YACLN,SAAS;YACTO,SAAS;YACTN,MAAMG;QACR;IACF;IAEA,6CAA6C;IAC7C,+BAA+B;IAC/B,6CAA6C;IAE7C,MAEMK,eACJ,AAAaC,aAAqB,EAClC,AAA4BC,WAAmB,EAC/C;QACA,IAAI,CAACA,aAAa;YAChB,OAAO;gBACLX,SAAS;gBACTO,SAAS;YACX;QACF;QAEA,MAAMK,SAAS,MAAM,IAAI,CAACb,kBAAkB,CAACc,yBAAyB,CACpEF,aACAD;QAGF,OAAO;YACLV,SAAS;YACTC,MAAMW;QACR;IACF;IAEA,MAEME,eAAe,AAA4BH,WAAmB,EAAE;QACpE,IAAI,CAACA,aAAa;YAChB,OAAO;gBACLX,SAAS;gBACTC,MAAM,EAAE;YACV;QACF;QAEA,MAAMc,SACJ,MAAM,IAAI,CAAChB,kBAAkB,CAACiB,uBAAuB,CAACL;QACxD,OAAO;YACLX,SAAS;YACTC,MAAMc;QACR;IACF;IArGA,YAAY,AAAiBhB,kBAAsC,CAAE;aAAxCA,qBAAAA;IAAyC;AAsGxE;;;;;;;;;;;;;;;;;;;;;;mDAtEkBkB;;;;;;;;;;;mDAYAA"}