{"version":3,"sources":["../../../src/modules/test/test.controller.ts"],"sourcesContent":["import {\r\n    Controller,\r\n    Get,\r\n    Post,\r\n    Body,\r\n    Param,\r\n} from '@nestjs/common';\r\nimport { TestService } from './test.service';\r\nimport { CreateTestDto, AddQuestionDto, SubmitAnswerDto, TestEventDto } from './dto';\r\nimport { CurrentUser, Roles } from '../../common/decorators';\r\nimport { UserRole } from '../../common/constants';\r\n\r\n@Controller('tests')\r\nexport class TestController {\r\n    constructor(private readonly testService: TestService) { }\r\n\r\n    // ===========================================\r\n    // ADMIN: Test Management\r\n    // ===========================================\r\n\r\n    @Post()\r\n    @Roles(UserRole.ADMIN)\r\n    async createTest(@Body() dto: CreateTestDto) {\r\n        return this.testService.createTest(dto);\r\n    }\r\n\r\n    @Post(':testId/questions')\r\n    @Roles(UserRole.ADMIN)\r\n    async addQuestion(\r\n        @Param('testId') testId: string,\r\n        @Body() dto: AddQuestionDto,\r\n    ) {\r\n        return this.testService.addQuestion(testId, dto);\r\n    }\r\n\r\n    @Get(':testId')\r\n    @Roles(UserRole.ADMIN)\r\n    async getTest(@Param('testId') testId: string) {\r\n        return this.testService.getTestById(testId);\r\n    }\r\n\r\n    // ===========================================\r\n    // CANDIDATE: Test Taking\r\n    // ===========================================\r\n\r\n    @Post('application/:applicationId/start')\r\n    @Roles(UserRole.CANDIDATE)\r\n    async startTest(\r\n        @Param('applicationId') applicationId: string,\r\n        @CurrentUser('sub') userId: string,\r\n    ) {\r\n        return this.testService.startTest(applicationId, userId);\r\n    }\r\n\r\n    @Get('session/:sessionId')\r\n    @Roles(UserRole.CANDIDATE)\r\n    async getSession(\r\n        @Param('sessionId') sessionId: string,\r\n        @CurrentUser('sub') userId: string,\r\n    ) {\r\n        return this.testService.getTestSession(sessionId, userId);\r\n    }\r\n\r\n    @Post('session/:sessionId/answer')\r\n    @Roles(UserRole.CANDIDATE)\r\n    async submitAnswer(\r\n        @Param('sessionId') sessionId: string,\r\n        @CurrentUser('sub') userId: string,\r\n        @Body() dto: SubmitAnswerDto,\r\n    ) {\r\n        return this.testService.submitAnswer(sessionId, userId, dto);\r\n    }\r\n\r\n    @Post('session/:sessionId/submit')\r\n    @Roles(UserRole.CANDIDATE)\r\n    async submitTest(\r\n        @Param('sessionId') sessionId: string,\r\n        @CurrentUser('sub') userId: string,\r\n    ) {\r\n        return this.testService.submitTest(sessionId, userId);\r\n    }\r\n\r\n    @Post('session/:sessionId/event')\r\n    @Roles(UserRole.CANDIDATE)\r\n    async logEvent(\r\n        @Param('sessionId') sessionId: string,\r\n        @CurrentUser('sub') userId: string,\r\n        @Body() dto: TestEventDto,\r\n    ) {\r\n        return this.testService.logTestEvent(sessionId, userId, dto);\r\n    }\r\n}\r\n"],"names":["TestController","createTest","dto","testService","addQuestion","testId","getTest","getTestById","startTest","applicationId","userId","getSession","sessionId","getTestSession","submitAnswer","submitTest","logEvent","logTestEvent","ADMIN","CANDIDATE"],"mappings":";;;;+BAaaA;;;eAAAA;;;wBAPN;6BACqB;qBACiD;4BAC1C;2BACV;;;;;;;;;;;;;;;AAGlB,IAAA,AAAMA,iBAAN,MAAMA;IAGT,8CAA8C;IAC9C,yBAAyB;IACzB,8CAA8C;IAE9C,MAEMC,WAAW,AAAQC,GAAkB,EAAE;QACzC,OAAO,IAAI,CAACC,WAAW,CAACF,UAAU,CAACC;IACvC;IAEA,MAEME,YACF,AAAiBC,MAAc,EAC/B,AAAQH,GAAmB,EAC7B;QACE,OAAO,IAAI,CAACC,WAAW,CAACC,WAAW,CAACC,QAAQH;IAChD;IAEA,MAEMI,QAAQ,AAAiBD,MAAc,EAAE;QAC3C,OAAO,IAAI,CAACF,WAAW,CAACI,WAAW,CAACF;IACxC;IAEA,8CAA8C;IAC9C,yBAAyB;IACzB,8CAA8C;IAE9C,MAEMG,UACF,AAAwBC,aAAqB,EAC7C,AAAoBC,MAAc,EACpC;QACE,OAAO,IAAI,CAACP,WAAW,CAACK,SAAS,CAACC,eAAeC;IACrD;IAEA,MAEMC,WACF,AAAoBC,SAAiB,EACrC,AAAoBF,MAAc,EACpC;QACE,OAAO,IAAI,CAACP,WAAW,CAACU,cAAc,CAACD,WAAWF;IACtD;IAEA,MAEMI,aACF,AAAoBF,SAAiB,EACrC,AAAoBF,MAAc,EAClC,AAAQR,GAAoB,EAC9B;QACE,OAAO,IAAI,CAACC,WAAW,CAACW,YAAY,CAACF,WAAWF,QAAQR;IAC5D;IAEA,MAEMa,WACF,AAAoBH,SAAiB,EACrC,AAAoBF,MAAc,EACpC;QACE,OAAO,IAAI,CAACP,WAAW,CAACY,UAAU,CAACH,WAAWF;IAClD;IAEA,MAEMM,SACF,AAAoBJ,SAAiB,EACrC,AAAoBF,MAAc,EAClC,AAAQR,GAAiB,EAC3B;QACE,OAAO,IAAI,CAACC,WAAW,CAACc,YAAY,CAACL,WAAWF,QAAQR;IAC5D;IA5EA,YAAY,AAAiBC,WAAwB,CAAE;aAA1BA,cAAAA;IAA4B;AA6E7D;;;+CAtEoBe;;;;;;;;;;+CAMAA;;;;;;;;;;;;+CASAA;;;;;;;;;;+CAUAC;;;;;;;;;;;;+CASAA;;;;;;;;;;;;+CASAA;;;;;;;;;;;;;;+CAUAA;;;;;;;;;;;;+CASAA"}